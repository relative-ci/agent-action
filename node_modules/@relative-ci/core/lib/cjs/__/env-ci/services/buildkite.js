'use strict';

var git = require('../lib/git.js');

// https://buildkite.com/docs/builds/environment-variables

var buildkite = {
  detect({ env }) {
    return Boolean(env.BUILDKITE);
  },
  configuration({ env }) {
    const pr =
      env.BUILDKITE_PULL_REQUEST === "false"
        ? undefined
        : env.BUILDKITE_PULL_REQUEST;
    const isPr = Boolean(pr);

    return {
      name: "Buildkite",
      service: "buildkite",
      build: env.BUILDKITE_BUILD_NUMBER,
      buildUrl: env.BUILDKITE_BUILD_URL,
      commit: env.BUILDKITE_COMMIT,
      tag: env.BUILDKITE_TAG,
      branch: isPr
        ? env.BUILDKITE_PULL_REQUEST_BASE_BRANCH
        : env.BUILDKITE_BRANCH,
      slug: git.getSlugFromGitURL(env.BUILDKITE_REPO),
      pr,
      isPr,
      prBranch: isPr ? env.BUILDKITE_BRANCH : undefined,
      root: env.BUILDKITE_BUILD_CHECKOUT_PATH,
    };
  },
};

module.exports = buildkite;
//# sourceMappingURL=buildkite.js.map
